const {
  GoogleGenerativeAI,
  HarmCategory,
  HarmBlockThreshold,
} = require("@google/generative-ai");

const apiKey = process.env.EXPO_PUBLIC_GOOGLE_GEMINI_API_KEY;
const genAI = new GoogleGenerativeAI(apiKey);

const model = genAI.getGenerativeModel({
  model: "gemini-1.5-flash",
});

const generationConfig = {
  temperature: 1,
  topP: 0.95,
  topK: 64,
  maxOutputTokens: 8192,
  responseMimeType: "application/json",
};

export const chatSession = model.startChat({
  generationConfig,
  history: [
    {
      role: "user",
      parts: [
        {
          text: "Generate Travel plan for Location: New York USA, for 1 Days and 1 Night for Family with a luxury budget with a Flight Details, Flight Price with booking url, Hotels options list with HotelName, Hotel address, Price, hotel image url, geo coordinates, rating, descriptions and places to visit nearby with PlaceName, Place Details, Place Image Url, Geo Coordinates, Ticket Pricing, time to travel each of the location for 1 Days and 1 night with each day plan with best time to visit in JSON format",
        },
      ],
    },
    {
      role: "model",
      parts: [
        {
          text: '```json\n{\n  "flight_details": {\n    "airline": "Delta Airlines",\n    "flight_number": "DL1234",\n    "departure_city": "Los Angeles",\n    "departure_airport": "LAX",\n    "arrival_city": "New York",\n    "arrival_airport": "JFK",\n    "departure_date": "2023-12-15",\n    "departure_time": "10:00 AM",\n    "arrival_date": "2023-12-15",\n    "arrival_time": "1:00 PM",\n    "price": "$500",\n    "booking_url": "https://www.delta.com/booking"\n  },\n  "hotel": [\n    {\n      "hotel_name": "The Peninsula New York",\n      "hotel_address": "700 Fifth Avenue, New York, NY 10019",\n      "price": "$1500+",\n      "hotel_image_url": "https://www.thepeninsula.com/newyork/en/images/hotel/slideshow/hotel-exterior-day.jpg",\n      "geo_coordinates": {\n        "latitude": 40.7580,\n        "longitude": -73.9855\n      },\n      "rating": 4.5,\n      "description": "A luxurious and iconic hotel in Midtown Manhattan, known for its elegant rooms and suites, world-class dining, and impeccable service.",\n      "places_to_visit_nearby": [\n        {\n          "place_name": "Central Park",\n          "place_details": "A sprawling urban oasis, perfect for a stroll, a picnic, or a bike ride.",\n          "place_image_url": "https://www.nycgovparks.org/images/parks/central-park/central-park-fall-foliage.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7829,\n            "longitude": -73.9654\n          },\n          "ticket_pricing": "Free",\n          "time_to_travel": "1-2 hours"\n        },\n        {\n          "place_name": "Rockefeller Center",\n          "place_details": "A famous complex of Art Deco skyscrapers, home to the iconic Top of the Rock observation deck.",\n          "place_image_url": "https://www.rockefellercenter.com/sites/default/files/styles/hero_image_2000x1000/public/images/hero-images/nyc-skyline-from-top-of-the-rock.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7580,\n            "longitude": -73.9788\n          },\n          "ticket_pricing": "$39+",\n          "time_to_travel": "2-3 hours"\n        }\n      ]\n    },\n    {\n      "hotel_name": "The Ritz-Carlton New York, Central Park",\n      "hotel_address": "50 Central Park South, New York, NY 10019",\n      "price": "$1200+",\n      "hotel_image_url": "https://www.ritzcarlton.com/en/hotels/new-york/central-park/images/hotel-overview/hotel-exterior.jpg",\n      "geo_coordinates": {\n        "latitude": 40.7649,\n        "longitude": -73.9767\n      },\n      "rating": 4.8,\n      "description": "A luxurious hotel with stunning Central Park views, elegant accommodations, and exceptional dining experiences.",\n      "places_to_visit_nearby": [\n        {\n          "place_name": "Museum of Modern Art (MoMA)",\n          "place_details": "A world-renowned museum showcasing modern and contemporary art.",\n          "place_image_url": "https://www.moma.org/images/collection/MoMA_00000.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7614,\n            "longitude": -73.9777\n          },\n          "ticket_pricing": "$25+",\n          "time_to_travel": "2-3 hours"\n        },\n        {\n          "place_name": "Carnegie Hall",\n          "place_details": "A legendary concert hall known for its exceptional acoustics and world-class performances.",\n          "place_image_url": "https://www.carnegiehall.org/media/images/carnegie-hall-main-hall.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7570,\n            "longitude": -73.9802\n          },\n          "ticket_pricing": "Varies by performance",\n          "time_to_travel": "1-2 hours"\n        }\n      ]\n    },\n    {\n      "hotel_name": "The Four Seasons Hotel New York Downtown",\n      "hotel_address": "27 Barclay Street, New York, NY 10007",\n      "price": "$1000+",\n      "hotel_image_url": "https://www.fourseasons.com/images/hotels/nydowntown/gallery/exterior-01.jpg",\n      "geo_coordinates": {\n        "latitude": 40.7128,\n        "longitude": -74.0127\n      },\n      "rating": 4.7,\n      "description": "A luxurious hotel in Tribeca, offering stylish accommodations, a rooftop bar, and exceptional dining options.",\n      "places_to_visit_nearby": [\n        {\n          "place_name": "The 9/11 Memorial & Museum",\n          "place_details": "A moving tribute to the victims of the September 11th attacks.",\n          "place_image_url": "https://www.911memorial.org/sites/default/files/styles/large/public/images/header-hero/memorial-reflecting-pools-night.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7128,\n            "longitude": -74.0127\n          },\n          "ticket_pricing": "$26+",\n          "time_to_travel": "2-3 hours"\n        },\n        {\n          "place_name": "World Trade Center Observatory",\n          "place_details": "An observation deck offering stunning views of the city skyline.",\n          "place_image_url": "https://www.oneworldobservatory.com/sites/default/files/styles/hero/public/images/hero-one-world-observatory-nyc-skyline-sunset-view.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7128,\n            "longitude": -74.0127\n          },\n          "ticket_pricing": "$39+",\n          "time_to_travel": "1-2 hours"\n        }\n      ]\n    }\n  ],\n  "day_plan": [\n    {\n      "day": 1,\n      "time": "Morning (10:00 AM - 1:00 PM)",\n      "activity": "Check into your hotel and enjoy a leisurely lunch at one of the hotel\'s fine dining restaurants. Take a stroll through Central Park and enjoy the vibrant atmosphere.",\n      "places": [\n        {\n          "place_name": "Central Park",\n          "place_details": "A sprawling urban oasis, perfect for a stroll, a picnic, or a bike ride.",\n          "place_image_url": "https://www.nycgovparks.org/images/parks/central-park/central-park-fall-foliage.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7829,\n            "longitude": -73.9654\n          },\n          "ticket_pricing": "Free",\n          "time_to_travel": "1-2 hours"\n        }\n      ]\n    },\n    {\n      "day": 1,\n      "time": "Afternoon (2:00 PM - 5:00 PM)",\n      "activity": "Visit the Metropolitan Museum of Art, a world-renowned museum housing masterpieces from across history and cultures.",\n      "places": [\n        {\n          "place_name": "Metropolitan Museum of Art",\n          "place_details": "A world-renowned museum housing masterpieces from across history and cultures.",\n          "place_image_url": "https://www.metmuseum.org/sites/default/files/styles/met-gallery-wide/public/images/2014-01-07-836-1389131168.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7794,\n            "longitude": -73.9632\n          },\n          "ticket_pricing": "Suggested donation: $25+",\n          "time_to_travel": "2-3 hours"\n        }\n      ]\n    },\n    {\n      "day": 1,\n      "time": "Evening (6:00 PM - 10:00 PM)",\n      "activity": "Enjoy a delicious dinner at one of New York\'s Michelin-starred restaurants, followed by a Broadway show.",\n      "places": [\n        {\n          "place_name": "Per Se",\n          "place_details": "A three-Michelin-starred restaurant by Chef Thomas Keller, offering an exquisite tasting menu.",\n          "place_image_url": "https://www.thomaskeller.com/per-se/img/pages/gallery-02.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7609,\n            "longitude": -73.9815\n          },\n          "ticket_pricing": "$400+",\n          "time_to_travel": "2-3 hours"\n        },\n        {\n          "place_name": "Hamilton",\n          "place_details": "A critically acclaimed Broadway musical about the life of Alexander Hamilton.",\n          "place_image_url": "https://www.broadway.com/wp-content/uploads/2017/07/Hamilton-Broadway-Show-Ticket-Photo.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7570,\n            "longitude": -73.9802\n          },\n          "ticket_pricing": "$100+",\n          "time_to_travel": "3 hours"\n        }\n      ]\n    },\n    {\n      "day": 2,\n      "time": "Morning (10:00 AM - 1:00 PM)",\n      "activity": "Start the day with a visit to the Statue of Liberty and Ellis Island. Take a ferry ride to the iconic landmark and explore its history and significance.",\n      "places": [\n        {\n          "place_name": "Statue of Liberty & Ellis Island",\n          "place_details": "A must-see attraction in New York City, offering a glimpse into American history.",\n          "place_image_url": "https://www.nps.gov/stli/learn/historyculture/images/statue-of-liberty-ellis-island.jpg",\n          "geo_coordinates": {\n            "latitude": 40.6892,\n            "longitude": -74.0445\n          },\n          "ticket_pricing": "$30+",\n          "time_to_travel": "3-4 hours"\n        }\n      ]\n    },\n    {\n      "day": 2,\n      "time": "Afternoon (2:00 PM - 5:00 PM)",\n      "activity": "Enjoy a luxurious high tea at The Plaza Hotel, followed by some shopping on Fifth Avenue.",\n      "places": [\n        {\n          "place_name": "The Plaza Hotel",\n          "place_details": "A luxurious hotel known for its elegant afternoon tea service.",\n          "place_image_url": "https://www.theplazanewyork.com/sites/default/files/styles/hero_image_1600x900/public/2020-07/ThePlaza_Exterior_Summer.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7580,\n            "longitude": -73.9775\n          },\n          "ticket_pricing": "$60+",\n          "time_to_travel": "2 hours"\n        },\n        {\n          "place_name": "Fifth Avenue",\n          "place_details": "A world-famous shopping destination, home to designer boutiques and luxury brands.",\n          "place_image_url": "https://www.timeout.com/newyork/images/102414295.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7577,\n            "longitude": -73.9772\n          },\n          "ticket_pricing": "Varies by store",\n          "time_to_travel": "2 hours"\n        }\n      ]\n    },\n    {\n      "day": 2,\n      "time": "Evening (6:00 PM - 9:00 PM)",\n      "activity": "Enjoy a farewell dinner at one of the city\'s iconic rooftop restaurants, offering breathtaking views of the skyline. ",\n      "places": [\n        {\n          "place_name": "The Roof at Park South",\n          "place_details": "A rooftop bar and restaurant with panoramic views of the city.",\n          "place_image_url": "https://media-cdn.tripadvisor.com/media/photo-s/18/57/8b/a0/the-roof-at-park-south.jpg",\n          "geo_coordinates": {\n            "latitude": 40.7540,\n            "longitude": -73.9843\n          },\n          "ticket_pricing": "Varies by restaurant",\n          "time_to_travel": "2 hours"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Explanation:**\n\nThis JSON format provides a comprehensive travel plan for a family in New York City with a luxury budget. It covers flight details, hotel options, daily itineraries with best time to visit and places to visit.\n\n**Here\'s a breakdown of the key elements:**\n\n- **flight_details:** Information about the flight including airline, flight number, departure and arrival cities and airports, dates and times, price and booking URL.\n- **hotel:** A list of luxurious hotel options including hotel name, address, price, image URL, geo coordinates, rating, description and nearby places to visit.\n- **day_plan:**  A structured itinerary for each day with the following information for each activity:\n    - **day:** Day number.\n    - **time:** Time of the day.\n    - **activity:** Description of the activity.\n    - **places:** A list of places to visit during the activity, including details like name, description, image URL, geo coordinates, ticket price, and recommended time to spend.\n\n**Customization:**\n\nYou can easily customize this plan by:\n\n- **Changing flight details:** Update airline, flight number, dates, times, and price based on your preferences.\n- **Selecting a different hotel:** Choose a hotel that suits your budget and preferences from the provided list or add more hotels.\n- **Modifying day plan:** Adjust the activities, places, and timings based on your family\'s interests.\n\nThis JSON format offers a structured and flexible framework to plan a luxurious family trip to New York City. \n',
        },
      ],
    },
  ],
});
